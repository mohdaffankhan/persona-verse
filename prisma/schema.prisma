generator client {
  provider = "prisma-client-js"
  output   = "../lib/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum MessageRole {
  USER
  ASSISTANT
}

model User {
  id           String         @id @default(cuid())
  email        String         @unique
  name         String?
  profileImage String?
  personas     Persona[]
  chats        ChatSessions[]
}

model Persona {
  id                String   @id @default(cuid())
  name              String
  language          String
  tone              String
  description       String
  bio               String
  behaviouralTraits String
  socials           String?
  dosdonts          String?
  avatarUrl         String?
  commonPhrases     String?
  user              User?    @relation(fields: [userId], references: [id])
  userId            String?
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt
}

model ChatSessions {
  id        String    @id @default(cuid())
  personaId String
  messages  Message[]
  user      User      @relation(fields: [userId], references: [id])
  userId    String
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
}

model Message {
  id        String       @id @default(cuid())
  content   String
  role      MessageRole
  chat      ChatSessions @relation(fields: [chatId], references: [id])
  chatId    String
  createdAt DateTime     @default(now())
  updatedAt DateTime     @updatedAt
}
